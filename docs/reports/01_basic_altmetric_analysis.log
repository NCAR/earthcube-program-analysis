Traceback (most recent call last):
  File "C:\Users\kmaull\Anaconda3\envs\soarsbook\lib\site-packages\jupyter_cache\executors\utils.py", line 51, in single_nb_execution
    executenb(
  File "C:\Users\kmaull\Anaconda3\envs\soarsbook\lib\site-packages\nbclient\client.py", line 1204, in execute
    return NotebookClient(nb=nb, resources=resources, km=km, **kwargs).execute()
  File "C:\Users\kmaull\Anaconda3\envs\soarsbook\lib\site-packages\nbclient\util.py", line 84, in wrapped
    return just_run(coro(*args, **kwargs))
  File "C:\Users\kmaull\Anaconda3\envs\soarsbook\lib\site-packages\nbclient\util.py", line 62, in just_run
    return loop.run_until_complete(coro)
  File "C:\Users\kmaull\Anaconda3\envs\soarsbook\lib\asyncio\base_events.py", line 647, in run_until_complete
    return future.result()
  File "C:\Users\kmaull\Anaconda3\envs\soarsbook\lib\site-packages\nbclient\client.py", line 663, in async_execute
    await self.async_execute_cell(
  File "C:\Users\kmaull\Anaconda3\envs\soarsbook\lib\site-packages\nbclient\client.py", line 965, in async_execute_cell
    await self._check_raise_for_error(cell, cell_index, exec_reply)
  File "C:\Users\kmaull\Anaconda3\envs\soarsbook\lib\site-packages\nbclient\client.py", line 862, in _check_raise_for_error
    raise CellExecutionError.from_cell_and_msg(cell, exec_reply_content)
nbclient.exceptions.CellExecutionError: An error occurred while executing the following cell:
------------------
df_altmetric = \
    df.merge(
        df_citations\
            .merge(df_projects).set_index('doi')\
            .merge(df, left_index=True, right_index=True),\
        left_index=True, right_index=True
        )\
      .reset_index()\
      .drop_duplicates('doi', keep='first')\
      .set_index('doi').drop('altmetric_score_y', axis=1)\
      .rename(columns={'altmetric_score_x': 'altmetric_score'})\
      .sort_values(by='altmetric_score', ascending=False)
------------------

[1;31m---------------------------------------------------------------------------[0m
[1;31mValueError[0m                                Traceback (most recent call last)
Cell [1;32mIn [8], line 3[0m
[0;32m      1[0m df_altmetric [38;5;241m=[39m \
[0;32m      2[0m     df[38;5;241m.[39mmerge(
[1;32m----> 3[0m         [43mdf_citations[49m[43m\[49m
[0;32m      4[0m [43m            [49m[38;5;241;43m.[39;49m[43mmerge[49m[43m([49m[43mdf_projects[49m[43m)[49m[38;5;241m.[39mset_index([38;5;124m'[39m[38;5;124mdoi[39m[38;5;124m'[39m)\
[0;32m      5[0m             [38;5;241m.[39mmerge(df, left_index[38;5;241m=[39m[38;5;28;01mTrue[39;00m, right_index[38;5;241m=[39m[38;5;28;01mTrue[39;00m),\
[0;32m      6[0m         left_index[38;5;241m=[39m[38;5;28;01mTrue[39;00m, right_index[38;5;241m=[39m[38;5;28;01mTrue[39;00m
[0;32m      7[0m         )\
[0;32m      8[0m       [38;5;241m.[39mreset_index()\
[0;32m      9[0m       [38;5;241m.[39mdrop_duplicates([38;5;124m'[39m[38;5;124mdoi[39m[38;5;124m'[39m, keep[38;5;241m=[39m[38;5;124m'[39m[38;5;124mfirst[39m[38;5;124m'[39m)\
[0;32m     10[0m       [38;5;241m.[39mset_index([38;5;124m'[39m[38;5;124mdoi[39m[38;5;124m'[39m)[38;5;241m.[39mdrop([38;5;124m'[39m[38;5;124maltmetric_score_y[39m[38;5;124m'[39m, axis[38;5;241m=[39m[38;5;241m1[39m)\
[0;32m     11[0m       [38;5;241m.[39mrename(columns[38;5;241m=[39m{[38;5;124m'[39m[38;5;124maltmetric_score_x[39m[38;5;124m'[39m: [38;5;124m'[39m[38;5;124maltmetric_score[39m[38;5;124m'[39m})\
[0;32m     12[0m       [38;5;241m.[39msort_values(by[38;5;241m=[39m[38;5;124m'[39m[38;5;124maltmetric_score[39m[38;5;124m'[39m, ascending[38;5;241m=[39m[38;5;28;01mFalse[39;00m)

File [1;32m~\Anaconda3\envs\soarsbook\lib\site-packages\pandas\core\frame.py:10083[0m, in [0;36mDataFrame.merge[1;34m(self, right, how, on, left_on, right_on, left_index, right_index, sort, suffixes, copy, indicator, validate)[0m
[0;32m  10064[0m [38;5;129m@Substitution[39m([38;5;124m"[39m[38;5;124m"[39m)
[0;32m  10065[0m [38;5;129m@Appender[39m(_merge_doc, indents[38;5;241m=[39m[38;5;241m2[39m)
[0;32m  10066[0m [38;5;28;01mdef[39;00m [38;5;21mmerge[39m(
[1;32m   (...)[0m
[0;32m  10079[0m     validate: [38;5;28mstr[39m [38;5;241m|[39m [38;5;28;01mNone[39;00m [38;5;241m=[39m [38;5;28;01mNone[39;00m,
[0;32m  10080[0m ) [38;5;241m-[39m[38;5;241m>[39m DataFrame:
[0;32m  10081[0m     [38;5;28;01mfrom[39;00m [38;5;21;01mpandas[39;00m[38;5;21;01m.[39;00m[38;5;21;01mcore[39;00m[38;5;21;01m.[39;00m[38;5;21;01mreshape[39;00m[38;5;21;01m.[39;00m[38;5;21;01mmerge[39;00m [38;5;28;01mimport[39;00m merge
[1;32m> 10083[0m     [38;5;28;01mreturn[39;00m [43mmerge[49m[43m([49m
[0;32m  10084[0m [43m        [49m[38;5;28;43mself[39;49m[43m,[49m
[0;32m  10085[0m [43m        [49m[43mright[49m[43m,[49m
[0;32m  10086[0m [43m        [49m[43mhow[49m[38;5;241;43m=[39;49m[43mhow[49m[43m,[49m
[0;32m  10087[0m [43m        [49m[43mon[49m[38;5;241;43m=[39;49m[43mon[49m[43m,[49m
[0;32m  10088[0m [43m        [49m[43mleft_on[49m[38;5;241;43m=[39;49m[43mleft_on[49m[43m,[49m
[0;32m  10089[0m [43m        [49m[43mright_on[49m[38;5;241;43m=[39;49m[43mright_on[49m[43m,[49m
[0;32m  10090[0m [43m        [49m[43mleft_index[49m[38;5;241;43m=[39;49m[43mleft_index[49m[43m,[49m
[0;32m  10091[0m [43m        [49m[43mright_index[49m[38;5;241;43m=[39;49m[43mright_index[49m[43m,[49m
[0;32m  10092[0m [43m        [49m[43msort[49m[38;5;241;43m=[39;49m[43msort[49m[43m,[49m
[0;32m  10093[0m [43m        [49m[43msuffixes[49m[38;5;241;43m=[39;49m[43msuffixes[49m[43m,[49m
[0;32m  10094[0m [43m        [49m[43mcopy[49m[38;5;241;43m=[39;49m[43mcopy[49m[43m,[49m
[0;32m  10095[0m [43m        [49m[43mindicator[49m[38;5;241;43m=[39;49m[43mindicator[49m[43m,[49m
[0;32m  10096[0m [43m        [49m[43mvalidate[49m[38;5;241;43m=[39;49m[43mvalidate[49m[43m,[49m
[0;32m  10097[0m [43m    [49m[43m)[49m

File [1;32m~\Anaconda3\envs\soarsbook\lib\site-packages\pandas\core\reshape\merge.py:111[0m, in [0;36mmerge[1;34m(left, right, how, on, left_on, right_on, left_index, right_index, sort, suffixes, copy, indicator, validate)[0m
[0;32m     94[0m [38;5;129m@Substitution[39m([38;5;124m"[39m[38;5;130;01m\n[39;00m[38;5;124mleft : DataFrame or named Series[39m[38;5;124m"[39m)
[0;32m     95[0m [38;5;129m@Appender[39m(_merge_doc, indents[38;5;241m=[39m[38;5;241m0[39m)
[0;32m     96[0m [38;5;28;01mdef[39;00m [38;5;21mmerge[39m(
[1;32m   (...)[0m
[0;32m    109[0m     validate: [38;5;28mstr[39m [38;5;241m|[39m [38;5;28;01mNone[39;00m [38;5;241m=[39m [38;5;28;01mNone[39;00m,
[0;32m    110[0m ) [38;5;241m-[39m[38;5;241m>[39m DataFrame:
[1;32m--> 111[0m     op [38;5;241m=[39m [43m_MergeOperation[49m[43m([49m
[0;32m    112[0m [43m        [49m[43mleft[49m[43m,[49m
[0;32m    113[0m [43m        [49m[43mright[49m[43m,[49m
[0;32m    114[0m [43m        [49m[43mhow[49m[38;5;241;43m=[39;49m[43mhow[49m[43m,[49m
[0;32m    115[0m [43m        [49m[43mon[49m[38;5;241;43m=[39;49m[43mon[49m[43m,[49m
[0;32m    116[0m [43m        [49m[43mleft_on[49m[38;5;241;43m=[39;49m[43mleft_on[49m[43m,[49m
[0;32m    117[0m [43m        [49m[43mright_on[49m[38;5;241;43m=[39;49m[43mright_on[49m[43m,[49m
[0;32m    118[0m [43m        [49m[43mleft_index[49m[38;5;241;43m=[39;49m[43mleft_index[49m[43m,[49m
[0;32m    119[0m [43m        [49m[43mright_index[49m[38;5;241;43m=[39;49m[43mright_index[49m[43m,[49m
[0;32m    120[0m [43m        [49m[43msort[49m[38;5;241;43m=[39;49m[43msort[49m[43m,[49m
[0;32m    121[0m [43m        [49m[43msuffixes[49m[38;5;241;43m=[39;49m[43msuffixes[49m[43m,[49m
[0;32m    122[0m [43m        [49m[43mindicator[49m[38;5;241;43m=[39;49m[43mindicator[49m[43m,[49m
[0;32m    123[0m [43m        [49m[43mvalidate[49m[38;5;241;43m=[39;49m[43mvalidate[49m[43m,[49m
[0;32m    124[0m [43m    [49m[43m)[49m
[0;32m    125[0m     [38;5;28;01mreturn[39;00m op[38;5;241m.[39mget_result(copy[38;5;241m=[39mcopy)

File [1;32m~\Anaconda3\envs\soarsbook\lib\site-packages\pandas\core\reshape\merge.py:710[0m, in [0;36m_MergeOperation.__init__[1;34m(self, left, right, how, on, left_on, right_on, axis, left_index, right_index, sort, suffixes, indicator, validate)[0m
[0;32m    702[0m (
[0;32m    703[0m     [38;5;28mself[39m[38;5;241m.[39mleft_join_keys,
[0;32m    704[0m     [38;5;28mself[39m[38;5;241m.[39mright_join_keys,
[0;32m    705[0m     [38;5;28mself[39m[38;5;241m.[39mjoin_names,
[0;32m    706[0m ) [38;5;241m=[39m [38;5;28mself[39m[38;5;241m.[39m_get_merge_keys()
[0;32m    708[0m [38;5;66;03m# validate the merge keys dtypes. We may need to coerce[39;00m
[0;32m    709[0m [38;5;66;03m# to avoid incompatible dtypes[39;00m
[1;32m--> 710[0m [38;5;28;43mself[39;49m[38;5;241;43m.[39;49m[43m_maybe_coerce_merge_keys[49m[43m([49m[43m)[49m
[0;32m    712[0m [38;5;66;03m# If argument passed to validate,[39;00m
[0;32m    713[0m [38;5;66;03m# check if columns specified as unique[39;00m
[0;32m    714[0m [38;5;66;03m# are in fact unique.[39;00m
[0;32m    715[0m [38;5;28;01mif[39;00m validate [38;5;129;01mis[39;00m [38;5;129;01mnot[39;00m [38;5;28;01mNone[39;00m:

File [1;32m~\Anaconda3\envs\soarsbook\lib\site-packages\pandas\core\reshape\merge.py:1343[0m, in [0;36m_MergeOperation._maybe_coerce_merge_keys[1;34m(self)[0m
[0;32m   1337[0m     [38;5;66;03m# unless we are merging non-string-like with string-like[39;00m
[0;32m   1338[0m     [38;5;28;01melif[39;00m (
[0;32m   1339[0m         inferred_left [38;5;129;01min[39;00m string_types [38;5;129;01mand[39;00m inferred_right [38;5;129;01mnot[39;00m [38;5;129;01min[39;00m string_types
[0;32m   1340[0m     ) [38;5;129;01mor[39;00m (
[0;32m   1341[0m         inferred_right [38;5;129;01min[39;00m string_types [38;5;129;01mand[39;00m inferred_left [38;5;129;01mnot[39;00m [38;5;129;01min[39;00m string_types
[0;32m   1342[0m     ):
[1;32m-> 1343[0m         [38;5;28;01mraise[39;00m [38;5;167;01mValueError[39;00m(msg)
[0;32m   1345[0m [38;5;66;03m# datetimelikes must match exactly[39;00m
[0;32m   1346[0m [38;5;28;01melif[39;00m needs_i8_conversion(lk[38;5;241m.[39mdtype) [38;5;129;01mand[39;00m [38;5;129;01mnot[39;00m needs_i8_conversion(rk[38;5;241m.[39mdtype):

[1;31mValueError[0m: You are trying to merge on object and int64 columns. If you wish to proceed you should use pd.concat
ValueError: You are trying to merge on object and int64 columns. If you wish to proceed you should use pd.concat

